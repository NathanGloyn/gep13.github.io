
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Subtle problem with StyleCop surrounding this. prefix - gep13&#8217;s blog</title>
	<meta name="author" content="gep13">

	
	<meta name="description" content="Website of Gary Ewan Park, also known as gep13, a self declared Microsoft Fan Boy, husband, dad, and geek." />

	
	<meta name="keywords" content="gep13, blog, Microsoft, Fan Boy, Ramblings, Pondering, Gary Ewan Park" />

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/feed" rel="alternate" title="gep13's blog" type="application/atom+xml">
	
	<link rel="canonical" href="http://www.gep13.co.uk/blog/subtle-problem-with-stylecop-surrounding-this-prefix/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
<link rel="stylesheet" type="text/css" href="http://assets.cookieconsent.silktide.com/current/style.min.css"/>
<script type="text/javascript" src="http://assets.cookieconsent.silktide.com/current/plugin.min.js"></script>
<script type="text/javascript">
	// <![CDATA[
		cc.initialise({
			cookies: {
				social: {
					title: 'Disqus et al.',
					description: 'Used for comments. You\'ll nee'+
							'd to log in to Disqus to leave'+
							' comments.'
				},
				analytics: {
					title: 'Analytics',
					description: 'Anonymously measure your use o'+
							'f this website to improve your'+
							' experience.'
				}
			},
			settings: {
				bannerPosition: "bottom",
				disableallsites: true
			}
		});
	// ]]>
</script>
<!-- End Cookie Consent plugin -->



<link rel="stylesheet" href="/ad-gallery/jquery.ad-gallery.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="/ad-gallery/jquery.ad-gallery.js?rand=302"></script>
<script type="text/javascript">
$(function() {
  var galleries = $('.ad-gallery').adGallery({
    loader_image: '/ad-gallery/loader.gif',
    width: 640,
  });
})
</script>
</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/adnuguk">ADNUGUK</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		<a class="facebook" href="http://www.facebook.com/gary.e.park" title="Facebook">Facebook</a>
		
		
		<a class="google" href="https://plus.google.com/+GaryEwanPark" rel="author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/gep13" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/gep13" title="GitHub">GitHub</a>
		
		
		
		<a class="linkedin" href="http://www.linkedin.com/in/gep13">LinkedIn</a>
		
		
		
		<a class="delicious" href="http://delicious.com/gep13" title="Delicious">Delicious</a>
		
		
		
		<a class="rss" href="/feed" title="RSS">RSS</a>
		
	</div>
</nav>
<div class="profile-container">
  <div class="profilepic">
    <script src="/javascripts/md5.js"></script>
    <script type="text/javascript">
$(function(){
  $('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("gep13@gep13.co.uk") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
});
    </script>
  </div>
  <hgroup>
  <h1 class="site-title"><a href="/">gep13&#8217;s blog</a></h1>
  
  <p class="site-subtitle">Ramblings and Ponderings of a Microsoft Fan Boy&#8230;</p>
  
  </hgroup>
  
</div>
</header>
			</div>
		</div>
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="article-inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
   	<div class="meta"> 
 		<div class="date">








  


<time datetime="2012-05-30T06:59:18+00:00" data-updated="true" itemprop="datePublished">May 30th, 2012</time></div> 
 		<div class="tags">


	<a class='category' href='/blog/categories/stylecop/'>stylecop</a>


</div> 
 		 
 			<span class="comments"><a href="#disqus_thread">Comments</a></span> 
 		 
 	</div> 
	
	<h1 class="title" itemprop="name">Subtle Problem With StyleCop Surrounding This. Prefix</h1>
	<div class="entry-content" itemprop="articleBody"><p>While preparing for my <a href="http://www.gep13.co.uk/blog/dddsw-4-stylecop-breaking-down-the-barriers-to-entry/">StyleCop presentation at DDDSW</a> I created a number of scripts for the demos that I wanted to show during the presentation.  For the first demo, which was a simple introduction to what StyleCop is and how it can be used, the script went like this:</p>

<ul>
<li><p>Create new Windows Forms Application using C#</p></li>
<li><p>Show that the Project Builds successfully</p></li>
<li><p>Run StyleCop at the solution level and show that there are <strong>30 Warnings</strong> out of the box (yes, this may seem like a lot of warnings for a brand new project, with no custom code, but this was covered in later demos.  If you want more information about how this can be corrected easily, feel free to give me a shout).</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>12 Warnings</strong> out of the box</p></li>
<li><p>Open StyleCop Settings and enter Copyright Information, as well as disable analysis of designer files</p></li>
<li><p>SA1633: Insert a copyright header to the top of Form1.cs using code snippet</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>11 Warnings</strong> left</p></li>
<li><p>SA1600: Insert a Summary Tag (with correct text) for the Form1 constructor</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>10 Warnings</strong> left</p></li>
<li><p>SA1200: Move all using statements within namespace</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>2 Warnings</strong> left</p></li>
<li><p>SA1601: To show the use of a SuppressMessage, suppress this warning</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>1 Warnings</strong> left</p></li>
<li><p>SA1101: Put a this. in front of the call to InitializeComponent</p></li>
<li><p>Run StyleCop on Form1.cs and show that there are <strong>0 Warnings</strong> left</p></li>
<li><p>Rejoice in the fact that StyleCop now runs with no warnings</p></li>
</ul>


<p>This was the plan, however, it turns out that this wasn’t going to be as easy as I thought!</p>

<p>When I first started creating my StyleCop Demos, and the scripts to go with it, I was using StyleCop 4.7.23 which at the time was the latest version, but unfortunately there was a bug in StyleCop surrounding SA1101.  Information on this can be found <a href="http://stylecop.codeplex.com/workitem/7266">here</a>.  What made things a little more interesting is that even though StyleCop wasn’t picking up the violation, the StyleCop for ReSharper plugin that I use was picking it up:</p>

<p><a href="http://www.gep13.co.uk/blog/wp-content/uploads/2012/05/Problem_with_this._and_resharper.png"><img src="http://www.gep13.co.uk/blog/wp-content/uploads/2012/05/Problem_with_this._and_resharper_thumb.png" alt="Problem_with_this._and_resharper" /></a></p>

<p>This didn’t make for a good demo, so I set about changing the script for the demo such that this bug wouldn’t be mentioned.  The morning of Saturday 26th May 2012 comes around and I am sitting in the speaker room adding the finishing touches to my slides and demos, only to find out that there is a new version of StyleCop been released, version 4.7.26.  Doing a little bit of digging, it appeared that this release fixed the issue that I was seeing, so with 1 hour before my presentation was due to start, I decided to install the latest version of StyleCop.</p>

<p>Now, I know that there are probably a lot of seasoned presenters out there that are shouting:</p>

<blockquote>WHAT THE HELL WERE YOU THINKING!!</blockquote>


<p>But, I am happy to say that the uninstall and reinstall of StyleCop went off without any problems, and on running through the script that I mentioned above, both StyleCop and StyleCop for ReSharper, correctly identify the violation:</p>

<p><a href="http://www.gep13.co.uk/blog/wp-content/uploads/2012/05/corrected_problem_with_this._and_resharper.png"><img src="http://www.gep13.co.uk/blog/wp-content/uploads/2012/05/corrected_problem_with_this._and_resharper_thumb.png" alt="corrected_problem_with_this._and_resharper" /></a></p>

<p><em>NOTE: The above screenshot is actually taken using StyleCop 4.7.27 (which was released on Tuesday 29th May 2012) and actually includes a new rule SA1126.  This appears to supersede the original violation which was SA1101.</em></p>

<p>So, long story short, if you are seeing oddities when running StyleCop, and StyleCop for ReSharper plugin, make sure that you have the most recent version of StyleCop installed.  In order to find out about new releases you can subscribe to the Release Notifications email on the CodePlex site <a href="http://stylecop.codeplex.com/releases/view/79972">here</a>.  You will need to log into CodePlex before you can enable this.</p>
</div>

</article>

	<div class="share">
	<!-- Go to www.addthis.com/dashboard to customize your tools -->
	<div class="addthis_sharing_toolbox"></div>

	<!-- Go to www.addthis.com/dashboard to customize your tools -->
	<script type="text/plain" class="cc-onconsent-social" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-54075e8542beba4d"></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - gep13 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

<p>Theme: <a href="https://github.com/qingwang/octopress-theme-yinyang">YinYang</a></p>
</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/plain" class="cc-onconsent-social">
      var disqus_shortname = 'gep13';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.gep13.co.uk/blog/subtle-problem-with-stylecop-surrounding-this-prefix/';
        var disqus_url = 'http://www.gep13.co.uk/blog/subtle-problem-with-stylecop-surrounding-this-prefix/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/plain" class="cc-onconsent-analytics">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-20926037-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




		</div>
	</div>
</body>
</html>
